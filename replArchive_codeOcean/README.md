# Replication Instructions (Code Ocean Capsule Prepared for Political Analysis Replicator)  

*Decomposing Influence Networks: Social Influence Regression*

This capsule bundles the exact data, code, and instructions necessary to reproduce the results discussed in *Decomposing Influence Networks: Social Influence Regression*. Please read this entire document before attempting to replicate the analysis. 

When you are ready, click the **Run** button (blue triangle) at the top of the page. This will launch the entire pipeline, which will run all scripts in order and generate all outputs. The capsule is designed to be self-contained, so you do not need to install any additional software or packages. Total runtime on the default Code Ocean hardware (4 vCPU / 8 GB RAM) is **1 hour 4 minutes 39 seconds**.

## 1. Folder Structure

Below is the folder structure within this replication archive:

| Path | Contents |
| ---- | -------- |
| `/data/` | Raw data used in the analysis |
| `/funcs/` | R helper functions |
| `/code/`  | All analysis scripts & `repl_soc_infl_reg.sh` (master driver) |
| `/results/` | `.rda` and `.pdf`files created at run-time |


## 2.  Running the Replication 

1. **Click Run** (blue triangle in the left sidebar).  
   *What happens under the hood*  
   * A fresh container is launched from that image.  
   * `/code` is mounted read‑only, `/data` and `/funcs` are mounted read‑only, and an empty `/results` directory is mounted read–write.  
   * The shell command defined in the **Run** tab—`bash repl_soc_infl_reg.sh`—executes:  
     1. **Housekeeping.** The script deletes any leftover PDFs, `.rda` files, or logs from previous runs.  
     2. **Sequential execution of R scripts.** Each numbered R script is called; progress messages stream to the console and are appended to `pipeline_log.txt`.  
     3. **Graceful exit.** When the last script finishes, the container prints `🏁 Pipeline completed`.  
   * Finally, Code Ocean copies everything that now exists in `/results` back to capsule storage so it’s available in the UI and to download.

2. **Verify outputs** – when the console ends with `🏁 Pipeline completed`, expand **/results** to see:

### 📄 Files generated by each script

| Script (auto‑called) | Manuscript element | Main output file(s) |
|----------------------|--------------------|---------------------|
| `01_plot_descrip.R`  | Figure 4 – descriptive maps | `figure4_jan05.pdf`, `figure4_dec12.pdf`, `map.pdf` |
| `02_run_model.R`     | Table 1 – model estimates | `alsModResults.rda` |
| `03_plot_coefs.R`    | Figure 5 – coefficient plot | `figure5.pdf` |
| `04_plot_influence.R`| Figure 6 – sender/receiver networks (Jun 2007)  | `aInfl_2007_06_01.pdf`, `bInfl_2007_06_01.pdf` |
|                      | Figure A2 – 9 additional monthly snapshots | *see full list below* |
| `05_run_perf.R`      | Inputs for Figures 7 & 8 | `alsModPerf.rda`, `alsModPerfLastPd.rda` |
| `06_plot_perf.R`     | Figure 7 and Figure 8 – performance plots | `figure7.pdf`, `figure8.pdf` |
| `07_plot_convergence.R` | Figure A1 – convergence diagnostics | `figurea1.pdf` |

#### Appendix Figure A2 Breakdown

| Month represented | Sender file | Receiver file |
|-------------------|-------------|---------------|
| February 2005 | `aInfl_2005_02_01.pdf` | `bInfl_2005_02_01.pdf` |
| September 2006 | `aInfl_2006_09_01.pdf` | `bInfl_2006_09_01.pdf` |
| June 2007 | `aInfl_2007_06_01.pdf` | `bInfl_2007_06_01.pdf` |
| April 2008 | `aInfl_2008_04_01.pdf` | `bInfl_2008_04_01.pdf` |
| January 2009 | `aInfl_2009_01_01.pdf` | `bInfl_2009_01_01.pdf` |
| October 2009 | `aInfl_2009_10_01.pdf` | `bInfl_2009_10_01.pdf` |
| August 2010 | `aInfl_2010_08_01.pdf` | `bInfl_2010_08_01.pdf` |
| May 2011 | `aInfl_2011_05_01.pdf` | `bInfl_2011_05_01.pdf` |
| December 2012 | `aInfl_2012_12_01.pdf` | `bInfl_2012_12_01.pdf` |

All files are written to `/results` at the end of a successful run; file names match the manuscript captions exactly.

3. Download any file via right‑click → **Download**.  
4. For a headless verification, click **Reproducible Run**.

## 3.  Software Environment

* Base image  `registry.codeocean.com/codeocean/r-base:3.4.4-ubuntu16.04`  
* Extra system libraries  `libcairo2‑dev`, `libpng‑dev`, `libtiff5‑dev`, `libpango1.0‑dev`, `libglpk‑dev`, `texlive‑extra‑utils`, `ghostscript`  
* `sessionInfo()` is logged at the top of `pipeline_log.txt`.

### Installed R Packages

|              |             |               |
|:-------------|:------------|:--------------|
|abind 1.4-5   |foreach 1.4.3 |magrittr 1.5   |
|Cairo 1.5-9   |gbm 2.1.3     |network 1.13.0 |
|countrycode 0.19 |ggplot2 2.2.1 |qgraph 1.4.4|
|cshapes 0.6   |grid 3.4.4    |reshape2 1.4.2 |
|doParallel 1.0.11 |gridExtra 2.3 |scales 0.5.0 |
|dplyr 0.7.4   |igraph 1.1.2  |speedglm 0.3-2 |
|extrafont 0.17 |latex2exp 0.4.0 |stringr 1.3.0 |

---

## 4. Contact

If you encounter any issues or have questions, please email [minhassh@msu.edu](mailto:minhassh@msu.edu).  
